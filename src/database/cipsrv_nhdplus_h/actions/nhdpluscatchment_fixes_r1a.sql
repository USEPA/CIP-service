DO $$DECLARE 
   r record;
   staticgeo GEOMETRY;
   patchgeo  GEOMETRY;
   step1geo  GEOMETRY;
   step2geo  GEOMETRY;
   int_srid  INTEGER := 5070;
   int_count INTEGER;
   
BEGIN
   /* Remove Overlaps - vals are (keep,clip) */
   FOR r IN SELECT * FROM (VALUES
       (60001800017446,60002600007118)
      ,(60001800017677,60002600009145)
      ,(60001800016056,60002600010685)
      ,(60001800017313,60002600006252)
      ,(60001800017364,60002600016436)
      ,(60001800017364,60002600017235)
      ,(60001800017827,60002600007970)
      ,(60001800017144,60002600012142)
      ,(60001800017710,60002600012142)
      ,(60001800019626,60002600013789)
      ,(60001800019569,60002600019679)
      ,(60001800019913,60002600019679)
      ,(60001800017889,60002600020656)
      ,(60001800019996,60002600006431)
      ,(60001800011880,60002600014488)
      ,(60001800003234,60002600012135)
      ,(60001800017530,60002500028266)
      ,(60001800014713,60002600009873)
      ,(60001800006892,60002600001203)
      ,(60001800006892,60002600014809)
      ,(60001800019410,60002600010698)
      ,(60001800003235,60002600010698)
      ,(60001800001676,60002600010698)
      ,(60001800015414,60002600010698)
      ,(60001800005602,60002600010698)
      ,(60001800003964,60002600010698)
      ,(60001800016037,60002600010698)
      ,(60001800013964,60002600010698)
      ,(60001800005931,60002600010698)
      ,(60001800019911,60002600010698)
      ,(60001800008604,60002600010698)
      ,(60001800007129,60002600010698)
      ,(60001800014615,60002600010698)
      ,(60001800000309,60002600010698)
      ,(60001800002116,60002600010698)
      ,(60001800000309,60002600018109)
      ,(60001800007129,60002600009887)
      ,(60001800017728,60002600014501)
      ,(60001800017728,60002600010235)
      ,(60001300003102,60002600016905)
      ,(60001300023408,60002600016925)
      ,(60001300025752,60002600017584)
      ,(60001300025752,60002600009892)
      ,(60001300117756,60002600009892)
      ,(60001300007466,60002600007513)
      ,(60001300024567,60002600004284)
      ,(60001300023191,60002600012344)
      ,(60001300023191,60002600143292)
      ,(60001300010685,60002600003404)
      ,(60001300010685,60002600006402)
      ,(60001900002643,60002500009230)
      ,(60001900007200,60002500007088)
      ,(60001900005280,60002500007088)
      ,(60001900005280,60002500014441)
      ,(60001900005280,60002500004422)
      ,(60001900000440,60002500004422)
      ,(60001900004782,60002500004422)
      ,(60001900006538,60002500004422)
      ,(60001900006538,60002500020720)
      ,(60001900008558,60002500020720)
      ,(60001900008558,60002500025639)
      ,(60001900009057,60002500026456)
      ,(60001900000149,60002500026992)
      ,(60001900006882,60002500026992)
      ,(60001900006882,60002500020831)
      ,(60001900007285,60002500020831)
      ,(60001900006999,60002500020831)
      ,(60001900004786,60002500004656)
      ,(60001900004786,60002500014124)
      ,(60001900004786,60002500011489)
      ,(60001900004786,60002500022545)
      ,(60001900010039,60002500022545)
      ,(60001900004774,60002500022545)
      ,(60001900005473,60002500022545)
      ,(60001900008604,60002500022545)
      ,(60001900006776,60002500022545)
      ,(60001900006776,60002500026476)
      ,(60001900005437,60002500011585)
      ,(60001900006113,60002500011585)
      ,(60001900006113,60002500025117)
      ,(60001900006113,60002500012015)
      ,(60001900007637,60002500002083)
      ,(60001900004921,60002500023184)
      ,(60001900005060,60002500018213)
      ,(60001900009393,60002500018213)
      ,(60001900009289,60002500018213)
      ,(60002500002295,60001900009412)
      ,(60002500002295,60001900009289)
      ,(60002500002295,60001900001800)
      ,(60001900006475,60002500002295)
      ,(60001900006475,60002500007600)
      ,(60001900006475,60002500014521)
      ,(60001900006475,60002500002070)
      ,(60001900006475,60002500014521)
      ,(60001900006017,60002500021148)
      ,(60001900005329,60002500021148)
      ,(60001900006489,60002500020491)
      ,(60001900006489,60002500023498)
      ,(60001900005329,60002500023498)
      ,(60001900005329,60002500023498)
      ,(60001900005329,60002500020043)
      ,(60001900005329,60002500007817)
      ,(60001900006878,60002500001584)
      ,(60001900006226,60002500006296)
      ,(60001900006226,60002500001584)
      ,(60001900006999,60002500020831)
      
      ,(60001900004865,60002500014750)
      ,(60002500014750,60001900004865)
      ,(60001900006774,60002500008667)
      ,(60001900006774,60002500021580)
      ,(60002500014988,60001900005808)
      ,(60001900005808,60002500003362)
      ,(60001900005808,60002500025441)
      ,(60002500008650,60001900005808)
      ,(60002500007388,60001900006131)
      ,(60002500025839,60001900006131)
      ,(60002500007811,60001900007672)
      ,(60001900006193,60002500007811)
      ,(60001900006193,60002500019840)
      ,(60002500017475,60001900006788)
      ,(60001900006788,60002500003824)
      ,(60002500003824,60001900006956)
      ,(60002500011248,60001900008413)
      ,(60002500011248,60001900007045)
      ,(60002500011248,60001900008413)
      ,(60001900002053,60002500011248)
      ,(60001900002053,60002500000933)
      ,(60002500012111,60001900006366)
      ,(60001900006366,60002500024549)
      ,(60002500005647,60001900005707)
      ,(60002500025223,60001900005707)
      ,(60001900006714,60002500007381)
      ,(60002500012106,60001900006996)
      ,(60002500006960,60001900005729)
      ,(60002500018160,60001900010183)
      ,(60002500018160,60001900010183)
      ,(60002500000944,60001900010183)
      ,(60001900004624,60002500001381)
      ,(60002500001381,60001900002920)
      ,(60001900007576,60002500003817)
      ,(60002500007381,60001900007576)
      ,(60001900005052,60002500013864)
      ,(60002500011441,60001900005052)
      ,(60002500015147,60001900001577)
      ,(60002500015147,60001900007381)
      ,(60002500012316,60001900007381)
      ,(60001900002696,60002500008646)
      ,(60002500027718,60001900002696)
      ,(60001900002696,60002500022661)
      ,(60001900002696,60002500013189)
      ,(60001900007694,60002500013864)
      ,(60001900007694,60002500013864)
      ,(60001900006957,60002500013864)
      ,(60002500013864,60001900005739)
      ,(60001900009936,60002500028171)
      ,(60001900001247,60002500021580)
      ,(60002500021580,60001900006339)
      ,(60002500021580,60001900005935)
      ,(60001900005329,60002500020491)
      ,(60001900005052,60002500013864)
      ,(60002500013864,60001900007273)
      ,(60002500017924,60001900007018)
      ,(60001900000046,60002500017924)
      ,(60001900007517,60002500022852)
      ,(60001900007517,60002500012115)
      ,(60002500006285,60001900007517)
      ,(60001900007576,60002500006728)
      ,(60002500006728,60001900005122)
      ,(60002500025837,60001900008410)
      ,(60002500020273,60001900002802)
      ,(60002500014076,60001900001839)
      ,(60001900008515,60002500025834)
      ,(60001900007576,60002500003817)
      ,(60002500006728,60001900007576)
      ,(60002700043312,60002900012401)
      ,(60002900012401,60002700037153)
      ,(60002900012305,60002700037686)
      ,(60002900050136,60002700022098)
      ,(60002700017854,60002900050136)
      ,(60002700033894,60002900050136)
      ,(60002700020141,60002900050136)
      ,(60002900050136,60002700029106)
      ,(60002700038371,60002900050136)
      ,(60002700038371,60002900017044)
      ,(60002700038371,60002900001193)
      ,(60002700052526,60002900058987)
      ,(60002900084839,60002700053294)
      ,(60002700045193,60002900009479)
      ,(60002900000007,60002700045193)
      ,(60002700048717,60002900017711)
      ,(60002900003597,60002700038717)
      ,(60002900029883,60002700038717)
      ,(60002700038232,60002900036651)
      ,(60002900036651,60002700038364)
      ,(60002900036651,60002700036841)
      ,(60002900011291,60002700036841)
      ,(60002700037804,60002900021611)
      ,(60002700041084,60002900020916)
      ,(60002700004775,60002900052031)
      ,(60003200019433,60002900052031)
      ,(60002900052031,60003200019433)
      ,(60003200029474,60002900052031)
      ,(60002900015384,60003200029474)
      ,(60003200029474,60002900025826)
      ,(60003200007095,60002900025826)
      ,(60003200007095,60002900049955)
      ,(60002900032719,60003200007095)
      ,(60002900013032,60003200003056)
      ,(60003200000300,60002900013032)
      ,(60003200019724,60002900013032)
      ,(60003200019724,60002900000002)
      ,(60002900031215,60003200038506)
      ,(60002900009549,60003200000018)
      ,(60002900009549,60003200004935)
      ,(60002900009549,60003200032887)
      ,(60002900009549,60003200032887)
      ,(60002900036577,60003200018546)
      ,(60002900036577,60003200000302)
      ,(60002900096041,60003200016643)
      ,(60001300100196,60002600079023)
      ,(60001300106091,60002600064154)
      ,(60001300116530,60002600108284)
      ,(60001300108609,60002600136353)
      ,(60002600123012,60001300103650)
      ,(60002600136691,60001300103386)
      ,(60001300114965,60002600107741)
      ,(60002600078700,60001300105961)
      ,(60002600093013,60001300099259)
      ,(60002600078475,60001300097275)
      ,(60001300076877,60002600077477)
      ,(60001300094247,60002600063969)
      ,(60001300104686,60002600107589)
      ,(60001300115030,60002600034013)
      ,(60002600078030,60001300115030)
      ,(60001300092047,60002600107166)
      ,(60001300093683,60002600107554)
      ,(60001300100416,60002600063627)
      ,(60001300116476,60002600136055)
      ,(60002600136733,60001300081345)
      ,(60002600063306,60001300096645)
      ,(60001300085970,60002600077695)
      ,(60002600046079,60001300085170)
      ,(60002600134352,60001300097583)
      ,(60002600046243,60001300098922)
      ,(60002600060659,60001300102422)
      ,(60002600055059,60001300100329)
      ,(60001300089444,60002600114675)
      ,(60002600069895,60001300102573)
      ,(60002600070941,60001300116409)
      ,(60001300114963,60002600054567)
      ,(60001300116467,60002600054567)
      ,(60002600083648,60001300112285)
      ,(60002600041349,60001300112201)
      ,(60002600071562,60001300112201)
      ,(60001300112211,60002600027015)
      ,(60001300116413,60002600027015)
      ,(60001300107110,60002600041553)
      ,(60001300107110,60002600041019)
      ,(60001300094612,60002600113953)
      ,(60001300090923,60002600113878)
      ,(60002600130101,60001300090305)
      ,(60002600130101,60001300111721)
      ,(60001300089120,60002600128587)
      ,(60001300082851,60002600128587)
      ,(60001300111144,60002600085047)
      ,(60001300089805,24001301430940)
      ,(60001300089805,24001300664321)
      ,(60002600027621,60001300090791)
      ,(60001300115365,24001301335845)
      ,(60001300116248,24001301145013)
      ,(24001300762913,60001300105338)
      ,(24001301338632,60001300107337)
      ,(24001300474432,60001300113220)
      ,(24001300955242,60001300111485)
      ,(60001300115359,24001301147547)
      ,(60001300079911,24001301051393)
      ,(60001300079911,24001301051393)
      ,(60001300079911,24001301051392)
      ,(60001300099833,24001300859380)
      ,(24001300092575,60001300115080)
      ,(24001300092575,60001300113265)
      ,(24001301528797,60001300114088)
      ,(60001300105178,24001300378841)
      ,(60001300114643,24001301242801)
      ,(24001301242801,60001300114642)
      ,(24001301242801,60001300023409)
      ,(60001300111584,24001301242801)
      ,(60001300079345,24001300091997)
      ,(60001300100426,24001300283061)
      ,(60001300066332,24001301146698)
      ,(60001300074822,24001300859088)
      ,(60001300072321,24001300283752)
      ,(24001301528441,60001300069328)
      ,(60001300075653,24001301528441)
      ,(24001300378482,60001300066872)
      ,(24001300283398,60001300066872)
      ,(60001300066872,24001301050557)
      ,(60001300066860,24001301050557)
      ,(24001300954651,60001300066860)
      ,(60001300066860,24001301433045)
      ,(24001300762566,60001300066860)
      ,(60001300073273,24001300762566)
      ,(24001300762566,60001300073271)
      ,(60001300073251,24001300570351)
      ,(60001300073251,24001300283394)
      ,(60001300075048,24001300283394)
      ,(60001300075039,24001300283394)
      ,(60001300075039,24001300858745)
      ,(24001300858747,60001300068345)
      ,(60001300074896,24001300762567)
      ,(60001300070724,24001301243074)
      ,(60001300073698,24001301243074)
      ,(60001300073698,24001301528773)
      ,(24001301528773,60001300072603)
      ,(24001301528773,60001300072603)
      ,(24001300762902,60001300072603)
      ,(24001301050862,60001300072603)
      ,(60001300072603,24001300954954)
      ,(24001300954954,60001300074647)
      ,(24001300378806,60001300074647)
      ,(60001300074645,24001300378806)
      ,(60001300071270,24001300762901)
      ,(24001300762901,60001300001956)
      ,(24001301243067,60001300073070)
      ,(60001300073030,24001301243067)
      ,(24001300570669,60001300068287)
      ,(24001301050859,60001300073930)
      ,(24001301529059,60001300073502)
      ,(24001300092566,60001300073502)
      ,(24001300092566,60001300071192)
      ,(24001300762887,60001300072885)
      ,(24001301528763,60001300072885)
      ,(60001300072885,24001301433348)
      ,(24001301433348,60001300069840)
      ,(60001300069840,24001301146970)
      ,(24001301146970,60001300072467)
      ,(60001300072467,24001300187897)
      ,(24001300187896,60001300073200)
      ,(24001300378787,60001300071547)
      ,(60001300071329,24001301433633)
      ,(24001300570974,60001300071522)
      ,(60001300069089,24001301338628)
      ,(24001301338628,60001300070413)
      ,(24001300475159,60001300068729)
      ,(60001300068729,24001301434115)
      ,(24001300764133,60001300062932)
      ,(60001300067834,24001301530163)
      ,(24001300475588,60001300116830)
      ,(60001300018526,24001301434737)
      ,(60001300064018,24001301434541)
      ,(24001300860287,60001300059685)
      ,(60001300059685,24001300380064)
      ,(24001300956160,60001300059425)
      ,(60001300063791,24001300956160)
      ,(60001300058669,24001300956160)
      ,(24001300093497,60001300058670)
      ,(60001300062321,24001300571874)
      ,(60001300060173,24001300189082)
      ,(60001300054565,24001301148224)
      ,(24001300093489,60001300054565)
   ) AS t(keep,clip)
   LOOP
      IF r.keep = r.clip
      OR r.keep IS NULL
      OR r.clip IS NULL
      THEN
         RAISE EXCEPTION 'QA problem % %',r.keep,r.clip;
      
      END IF;
      
      SELECT 
      cipsrv_nhdplus_h.snap_to_common_grid(ST_TRANSFORM(b.shape,int_srid),int_srid::VARCHAR,0.001)
      INTO
      step1geo
      FROM (
         SELECT
          aa.nhdplusid
         ,aa.shape
         FROM
         cipsrv_nhdplus_h.nhdpluscatchment aa
         UNION ALL
         SELECT
          bb.nhdplusid
         ,bb.shape
         FROM
         cipsrv_epageofab_h.grid0catchment bb
      ) b 
      WHERE 
      b.nhdplusid = r.keep;
      
      IF step1geo IS NULL
      OR ST_ISEMPTY(step1geo)
      OR ST_SRID(step1geo) = 0
      THEN
         RAISE EXCEPTION '% %',r.keep,r.clip;
         
      END IF;
      
      UPDATE cipsrv_nhdplus_h.nhdpluscatchment a
      SET shape = ST_TRANSFORM(ST_DIFFERENCE(
          cipsrv_nhdplus_h.snap_to_common_grid(ST_TRANSFORM(a.shape,int_srid),int_srid::VARCHAR,0.001)
         ,step1geo
      ),4269)
      WHERE 
      a.nhdplusid = r.clip;
      
      GET DIAGNOSTICS int_count = ROW_COUNT;

      IF int_count != 1
      THEN
         RAISE EXCEPTION 'error finding % in nhdpluscatchment',r.keep;

      END IF;         
      
      UPDATE cipsrv_nhdplus_h.nhdpluscatchment a
      SET areasqkm = ST_AREA(ST_TRANSFORM(a.shape,int_srid))::NUMERIC / 1000000
      WHERE 
      a.nhdplusid = r.clip;
        
   END LOOP;
   
   /* Remove Gaps - vals are (expand,static,patch,size)*/
   FOR r IN SELECT * FROM (VALUES
       (60001900006882,ARRAY[60002500017489],ST_POINT(-84.6570176,44.4918871,4269),15)
      ,(60001900006882,ARRAY[60002500017489],ST_POINT(-84.6524164,44.4913155,4269),15)
      ,(60001900009621,ARRAY[60001900006882,60002500026992],ST_POINT(-84.6348101,44.4888228,4269),15)
      ,(60001900009621,ARRAY[60002500026992],ST_POINT(-84.6295302,44.4862813,4269),15)
      ,(60001900009621,ARRAY[60002500026992],ST_POINT(-84.6248038,44.4864175,4269),15)
      ,(60001900002643,ARRAY[60002500026992],ST_POINT(-84.6121481,44.4735153,4269),15)
      ,(60001900002643,ARRAY[60002500009230],ST_POINT(-84.6181724,44.4618121,4269),15)     
      ,(60001900006999,ARRAY[60002500020831],ST_POINT(-84.7064125,44.5139123,4269),15)
      ,(60001900006999,ARRAY[60002500020831],ST_POINT(-84.7092246,44.5144378,4269),15)
      ,(60001900006999,ARRAY[60002500020831],ST_POINT(-84.7132628,44.5139491,4269),15)
      ,(60001900006999,ARRAY[60002500020831],ST_POINT(-84.7128387,44.5139123,4269),15)
      ,(60001900006999,ARRAY[60002500020831],ST_POINT(-84.7181677,44.5149172,4269),15)
      ,(60001900006999,ARRAY[60002500020831],ST_POINT(-84.7202975,44.5135711,4269),15)
      ,(60001900006999,ARRAY[60002500020831],ST_POINT(-84.7219110,44.5137094,4269),15)
      ,(60001900006999,ARRAY[60002500020831],ST_POINT(-84.7229251,44.5136725,4269),15)
      ,(60001900006999,ARRAY[60002500015505],ST_POINT(-84.7472788,44.5207069,4269),15)
      ,(60001900006999,ARRAY[60002500015505],ST_POINT(-84.7519417,44.5217507,4269),15)
      ,(60001900006019,ARRAY[60002500015505,60001900010039],ST_POINT(-84.758957,44.5231865,4269),15)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8089825,44.5239477,4269),15)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8108271,44.5238195,4269),25)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8210746,44.5228902,4269),15)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8398596,44.5206744,4269),15)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8428699,44.5208371,4269),15)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8482556,44.5182110,4269),15)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8531704,44.5161757,4269),15)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8596040,44.5149011,4269),15)
      ,(60001900004786,ARRAY[60002500024470],ST_POINT(-84.8482556,44.5182110,4269),15)
      ,(60001900004786,ARRAY[60002500004656],ST_POINT(-84.8680880,44.5181567,4269),15)
      ,(60001900004786,ARRAY[60002500004656],ST_POINT(-84.8732693,44.5182260,4269),15)
      ,(60001900004786,ARRAY[60002500004656],ST_POINT(-84.8770326,44.5185331,4269),15)
      ,(60001900004786,ARRAY[60002500004656],ST_POINT(-84.8772825,44.5361800,4269),15)
      ,(60001900004774,ARRAY[60002500022545],ST_POINT(-84.7811444,44.6155231,4269),15)
      ,(60001900004774,ARRAY[60002500022545,60001900005473],ST_POINT(-84.7799328,44.6174265,4269),15)
      ,(60001900005473,ARRAY[60002500022545,60001900004774],ST_POINT(-84.7797695,44.6174953,4269),15)
      ,(60001900005473,ARRAY[60002500022545],ST_POINT(-84.7786711,44.6189328,4269),15)
      ,(60002500026476,ARRAY[60001900006776],ST_POINT(-84.7604940,44.6782543,4269),15)
      ,(60002500026476,ARRAY[60001900006776],ST_POINT(-84.7541581,44.6818845,4269),15)
      ,(60001900005437,ARRAY[60002500026476],ST_POINT(-84.7516008,44.6841970,4269),15)
      ,(60001900005437,ARRAY[60002500026476],ST_POINT(-84.7510472,44.6837871,4269),15)
      ,(60001900005437,ARRAY[60002500026476],ST_POINT(-84.7618387,44.6936544,4269),15)
      ,(60001900005437,ARRAY[60002500026476],ST_POINT(-84.7758120,44.7000863,4269),15)
      ,(60001900005437,ARRAY[60002500026476],ST_POINT(-84.7775848,44.7000480,4269),15)
      ,(60001900005437,ARRAY[60002500026476],ST_POINT(-84.7791525,44.6999907,4269),15)
      ,(60001900005437,ARRAY[60002500026476],ST_POINT(-84.7817334,44.7011234,4269),15)
      ,(60001900006113,ARRAY[60002500025117],ST_POINT(-84.7930386,44.7439477,4269),15)
      ,(60001900009289,ARRAY[60002500018213],ST_POINT(-84.7998765,44.9911097,4269),15)
      ,(60001900009289,ARRAY[60002500018213],ST_POINT(-84.8011258,44.9913430,4269),15)
      ,(60001900009289,ARRAY[60002500018213],ST_POINT(-84.8116458,44.9978972,4269),15)
      ,(60001900006475,ARRAY[60002500002295],ST_POINT(-84.7924628,45.1095176,4269),15)
      ,(60001900006475,ARRAY[60002500002295],ST_POINT(-84.7932335,45.1093288,4269),15)
      ,(60001900006475,ARRAY[60002500002295],ST_POINT(-84.8196125,45.1126013,4269),15)
      ,(60001900006475,ARRAY[60002500002295],ST_POINT(-84.8279971,45.1199129,4269),15)
      ,(60001900006475,ARRAY[60002500002070],ST_POINT(-84.8294724,45.1539797,4269),15)
      ,(60001900006475,ARRAY[60002500021148],ST_POINT(-84.8192557,45.1537594,4269),15)
      ,(60001900006475,ARRAY[60002500002070],ST_POINT(-84.8294743,45.1539803,4269),15)
  
      ,(60002600133207,ARRAY[60001300102786,60001300092295],ST_POINT(-85.08097051,41.50133139,4269),15)
      ,(60002600084818,ARRAY[60001300111144,24001300568252],ST_POINT(-85.322666,41.321525,4269),15)
      ,(60001300108182,ARRAY[24001301433379,60001300069608],ST_POINT(-85.1930541,41.1575904,4269),15)
      ,(24001301243079,ARRAY[60001300071300,60001300075657],ST_POINT(-85.2021764,41.0832154,4269),15)
      ,(60001300066291,ARRAY[24001300188893],ST_POINT(-85.1074744,40.8748435,4269),15)
      ,(24001300188893,ARRAY[60001300066291,60001300066282],ST_POINT(-85.10675263,40.87477662,4269),30)
      ,(60001300062278,ARRAY[24001300860288,60001300059638],ST_POINT(-85.08511968,40.75148997,4269),15)
      ,(24001301148233,ARRAY[24001300860288,60001300062278],ST_POINT(-85.08516829,40.75113511,4269),15)
      ,(60002900096041,ARRAY[60003200016643],ST_POINT(-84.69158382,46.43952272,4269),15)
      ,(60003200016643,ARRAY[60002900023386],ST_POINT(-84.69572639,46.43287001,4269),15)
      ,(60002900023386,ARRAY[60003200016643],ST_POINT(-84.69627083,46.43128043,4269),15)
      ,(60002900023386,ARRAY[60003200000302,60002900036577],ST_POINT(-84.69653333,46.43047835,4269),15)
      ,(60003200000302,ARRAY[60002900036577,60002900023386],ST_POINT(-84.69671319,46.430228,4269),15)
      ,(60003200016643,ARRAY[60002900023386,60002900036577],ST_POINT(-84.69646771,46.43083321,4269),30)
      ,(60003200000302,ARRAY[60002900036577],ST_POINT(-84.7488048,46.41746131,4269),15)
      ,(60003200032887,ARRAY[60002900009549],ST_POINT(-84.794272,46.40514134,4269),15)
      ,(60003200027080,ARRAY[60002900009549],ST_POINT(-84.78757062,46.40921981,4269),15)
      ,(60003200032887,ARRAY[60002900009549],ST_POINT(-84.80359559,46.37802251,4269),15)
      ,(60002900009549,ARRAY[60003200000018],ST_POINT(-84.86974636,46.35812336,4269),15)
      ,(60002900031215,ARRAY[60003200000018],ST_POINT(-84.87970898,46.34476606,4269),15)
      ,(60002900009549,ARRAY[60003200032887],ST_POINT(-84.86854336,46.37609421,4269),15)
      ,(60003200000018,ARRAY[60002900009549],ST_POINT(-84.89572239,46.38367404,4269),15)
      ,(60002900009549,ARRAY[60003200032887],ST_POINT(-84.89660849,46.39227762,4269),15)
      ,(60002900009549,ARRAY[60003200000018],ST_POINT(-84.90861345,46.39153562,4269),15)
      ,(60002900061952,ARRAY[60003200038506],ST_POINT(-84.94735407,46.30552447,4269),15)
      ,(60002900000002,ARRAY[60003200038506],ST_POINT(-84.95397261,46.31114633,4269),15)
      ,(60002900000002,ARRAY[60003200038506],ST_POINT(-84.9588238,46.31335211,4269),15)
      ,(60002900000002,ARRAY[60003200019724],ST_POINT(-84.97229697,46.31617346,4269),15)
      ,(60002900000002,ARRAY[60003200019724],ST_POINT(-84.97641133,46.31495855,4269),15)
      ,(60003200019724,ARRAY[60002900013032],ST_POINT(-84.99806564,46.30791704,4269),15)
      ,(60002900013032,ARRAY[60003200019724],ST_POINT(-85.00907283,46.31143617,4269),15)
      ,(60003200019724,ARRAY[60002900013032],ST_POINT(-85.02059486,46.30964576,4269),15)
      ,(60003200000300,ARRAY[60002900013032],ST_POINT(-85.02143012,46.29364971,4269),15)
      ,(60003200000300,ARRAY[60002900013032],ST_POINT(-85.02353627,46.29272216,4269),15)
      ,(60002900032719,ARRAY[60003200007095],ST_POINT(-85.00916307,46.23048113,4269),15)
      ,(60002900032719,ARRAY[60003200007095],ST_POINT(-84.99444944,46.23200281,4269),15)
      ,(60003200007095,ARRAY[60002900010273,60002900032719],ST_POINT(-84.98894789,46.23024188,4269),45)
      ,(60002900015384,ARRAY[60003200029474,60002900025826],ST_POINT(-85.08208038,46.20141736,4269),15)
      ,(60002900025826,ARRAY[60003200029474],ST_POINT(-85.08083618,46.20658585,4269),15)
      ,(60002900015384,ARRAY[60003200029474],ST_POINT(-85.09185137,46.1825147,4269),15)
      ,(60002900015384,ARRAY[60003200029474],ST_POINT(-85.09552332,46.18785144,4269),25)
      ,(60002900052031,ARRAY[60003200019433],ST_POINT(-85.13098592,46.17712583,4269),15)
      ,(60003200019433,ARRAY[60002900052031],ST_POINT(-85.13362321,46.16662042,4269),15)
      ,(60002900052031,ARRAY[60003200019433],ST_POINT(-85.13369775,46.16618972,4269),15)
      ,(60003200019433,ARRAY[60002900052031],ST_POINT(-85.16729192,46.16515164,4269),15)
      ,(60003200019433,ARRAY[60002900052031],ST_POINT(-85.17168721,46.16450836,4269),15)
      ,(60002900052031,ARRAY[60002700030321,60003200019433],ST_POINT(-85.17837733,46.1618629,4269),15)
      ,(60002700052910,ARRAY[60002900052031,60002700030321],ST_POINT(-85.17760164,46.15989982,4269),30)
      ,(60002700052910,ARRAY[60002900052031],ST_POINT(-85.17583469,46.15984504,4269),15)
      ,(60002900052031,ARRAY[60002700052910],ST_POINT(-85.1763524,46.15979733,4269),30)
      ,(60002700052910,ARRAY[60002900052031],ST_POINT(-85.17542829,46.15999877,4269),15)
      ,(60002900052031,ARRAY[60002700052910],ST_POINT(-85.17501129,46.16013836,4269),15)
      ,(60002700052910,ARRAY[60002900052031],ST_POINT(-85.17432041,46.16036276,4269),15)
      ,(60002900052031,ARRAY[60002700052910],ST_POINT(-85.17391401,46.16050235,4269),15)
      ,(60002900052031,ARRAY[60002700052910],ST_POINT(-85.17270597,46.16059898,4269),55)
      ,(60002700052910,ARRAY[60002900052031,60002700004775],ST_POINT(-85.16281706,46.16152584,4269),15)
      ,(60002700036841,ARRAY[60002900005491,60002900059499],ST_POINT(-85.08610852,46.10312118,4269),15)
      ,(60002900028454,ARRAY[60002700042563],ST_POINT(-85.08181374,46.08036161,4269),15)
      ,(60002700042563,ARRAY[60002900064527,60002900028454],ST_POINT(-85.08079243,46.07948184,4269),15)
      ,(60002900003597,ARRAY[60002700038717],ST_POINT(-85.06065832,46.07866194,4269),15)
      ,(60002900003597,ARRAY[60002700038717],ST_POINT(-85.0571223,46.07810744,4269),15)
      ,(60002900017711,ARRAY[60002700040487],ST_POINT(-84.95263892,46.06262782,4269),15)
      ,(60002900000181,ARRAY[60002700048717,60002900017711],ST_POINT(-84.95971198,46.06385119,4269),15)
      ,(60002700037752,ARRAY[60002900000892,60002900035450],ST_POINT(-84.86428786,46.04107383,4269),15)
      ,(60002900035450,ARRAY[60002700053294],ST_POINT(-84.85392193,46.03477482,4269),15)
      ,(60002900084839,ARRAY[60002700053294],ST_POINT(-84.85021273,46.03292168,4269),15)
      ,(60002700052526,ARRAY[60002900058987],ST_POINT(-84.83298412,45.9988332,4269),15)
      ,(60002700052526,ARRAY[60002900058987,60002900001193],ST_POINT(-84.83197823,45.99786189,4269),15)
      ,(60002900001193,ARRAY[60002700038371,60002700052526],ST_POINT(-84.83296885,45.9965766,4269),15)
      ,(60002900050136,ARRAY[60002700017854],ST_POINT(-84.83375278,45.92207499,4269),15)
      ,(60002900050136,ARRAY[60002700033894],ST_POINT(-84.83979096,45.92619989,4269),30)
      ,(60002900050136,ARRAY[60002700033894],ST_POINT(-84.84014277,45.92722563,4269),15)
      ,(60002900050136,ARRAY[60002700020141],ST_POINT(-84.8433674,45.93075816,4269),30)
      ,(60002900050136,ARRAY[60002700029106],ST_POINT(-84.84817149,45.93650529,4269),15)
      ,(60002700029106,ARRAY[60002900050136],ST_POINT(-84.84946881,45.93725237,4269),15)
      ,(60002900050136,ARRAY[60002700038371],ST_POINT(-84.84820703,45.94013789,4269),15)
      ,(60002900050136,ARRAY[60002700038371],ST_POINT(-84.83976329,45.93871459,4269),15)
      ,(60002700022098,ARRAY[60002900050136],ST_POINT(-84.82385387,45.90084544,4269),15)
      ,(60002700042768,ARRAY[60002900050136],ST_POINT(-84.8197313,45.89452874,4269),15)
      ,(60002900050136,ARRAY[60002700029947],ST_POINT(-84.81690623,45.89437401,4269),15)
      ,(60002700036399,ARRAY[60002900012305],ST_POINT(-84.81344693,45.89491196,4269),15)
      ,(60002700036399,ARRAY[60002900012305,60002700036900],ST_POINT(-84.8056767,45.89181471,4269),15)
      ,(60002700036900,ARRAY[60002900012305,60002700036399],ST_POINT(-84.80463159,45.89181911,4269),15)
      ,(60002900012305,ARRAY[60002700037686],ST_POINT(-84.79657534,45.89123957,4269),15)
      ,(60002700037686,ARRAY[60002900012305],ST_POINT(-84.78959613,45.89111574,4269),15)
      ,(60002700037686,ARRAY[60002900012305],ST_POINT(-84.78499938,45.89299811,4269),15)
      ,(60002700037686,ARRAY[60002900012305],ST_POINT(-84.78258582,45.89297999,4269),30)
      ,(60002700037686,ARRAY[60002900012305],ST_POINT(-84.78137199,45.89297395,4269),15)
      ,(60002700037686,ARRAY[60002900012305],ST_POINT(-84.78014206,45.89296791,4269),30)
      ,(60002700037686,ARRAY[60002900012305],ST_POINT(-84.77885175,45.8929498,4269),30)
      ,(60002900018487,ARRAY[60002700037153],ST_POINT(-84.75722232,45.88634514,4269),15)
      ,(60002700037153,ARRAY[60002900018487],ST_POINT(-84.75659878,45.88619441,4269),15)
      ,(60002700037153,ARRAY[60002900018487],ST_POINT(-84.74935963,45.88306407,4269),15)
      ,(60002900012401,ARRAY[60002700037153,60002700036900],ST_POINT(-84.73994897,45.86449638,4269),15)
      ,(60003200000302,ARRAY[60002900036577],ST_POINT(-84.74879801,46.417465,4269),15)
      ,(60002900009479,ARRAY[60002700045193],ST_POINT(-84.91574524,46.04093906,4269),15)
      ,(60002900009479,ARRAY[60002700045193],ST_POINT(-84.92284389,46.04197383,4269),15)
      ,(60003200007095,ARRAY[60002900049955],ST_POINT(-85.06090359,46.21450265,4269),15)
      ,(60001900005052,ARRAY[60002500013864],ST_POINT(-84.90759924,45.46861526,4269),15)
      ,(60001900005052,ARRAY[60002500013864],ST_POINT(-84.92762017,45.47361245,4269),15)
      ,(60001900005052,ARRAY[60002500013864],ST_POINT(-84.92971176,45.47423936,4269),15)
      ,(60002500026232,ARRAY[60001900005052],ST_POINT(-84.95628504,45.48249046,4269),15)
      ,(60001900001577,ARRAY[60002500015147],ST_POINT(-84.96603022,45.49905902,4269),15)
      ,(60001900001577,ARRAY[60002500015147],ST_POINT(-84.96667648,45.49901835,4269),15)
      ,(60002500015147,ARRAY[60001900005022],ST_POINT(-84.97144538,45.51145636,4269),15)
      ,(60001900007381,ARRAY[60002500015147],ST_POINT(-84.97708108,45.50620745,4269),15)
      ,(60002500015147,ARRAY[60001900007381],ST_POINT(-84.99188205,45.51638954,4269),15)
      ,(60002500015147,ARRAY[60001900007381],ST_POINT(-84.99496966,45.51564809,4269),15)
      ,(60002500017703,ARRAY[60001900010072,60001900006301,60002500019009],ST_POINT(-85.03211504,45.53181615,4269),15)
      ,(60002500017703,ARRAY[60001900002696],ST_POINT(-85.03555876,45.53281266,4269),15)
      ,(60002500022661,ARRAY[60001900002696,60002500013189],ST_POINT(-85.0573666,45.55378497,4269),15)
      ,(60002500022661,ARRAY[60001900002696,60002500027718],ST_POINT(-85.05916591,45.54833335,4269),15)
      ,(60001900007672,ARRAY[60002500025839,60001900006131],ST_POINT(-85.01657866,45.59622845,4269),15)
      ,(60001900006788,ARRAY[60002500003824],ST_POINT(-84.9993052,45.6234482,4269),15)
      ,(60001900006788,ARRAY[60002500003824],ST_POINT(-84.99700062,45.62334583,4269),15)
      ,(60002500025839,ARRAY[60001900006131],ST_POINT(-85.03487011,45.60106735,4269),15)
      ,(60001900006131,ARRAY[60002500025839],ST_POINT(-85.0304791,45.60189107,4269),15)
      ,(60002500011248,ARRAY[60001900008413],ST_POINT(-84.95406702,45.61766768,4269),15)
      ,(60001900005707,ARRAY[60002500025223],ST_POINT(-84.88036461,45.66705902,4269),15)
      ,(60002500025223,ARRAY[60001900005707],ST_POINT(-84.87830597,45.66707364,4269),15)
      ,(60002500025223,ARRAY[60001900005707],ST_POINT(-84.87628828,45.66682069,4269),15)
      ,(60002500025223,ARRAY[60001900005707,60001900007662],ST_POINT(-84.86248444,45.66441399,4269),15)
      ,(60002500007381,ARRAY[60001900006714],ST_POINT(-84.81769401,45.66424037,4269),15)
      ,(60002500023729,ARRAY[60001900006166,60002500012106],ST_POINT(-84.86202296,45.67796809,4269),15)
      ,(60002500006728,ARRAY[60001900007576],ST_POINT(-84.71652653,45.64619514,4269),15)
      ,(60002500003817,ARRAY[60001900007576],ST_POINT(-84.75290584,45.65784651,4269),15)
      ,(60002500006289,ARRAY[60001900002443],ST_POINT(-84.66779174,45.67446142,4269),15)
      ,(60001900002920,ARRAY[60002500006289],ST_POINT(-84.66901532,45.67565684,4269),15)
      ,(60002500003817,ARRAY[60001900002920],ST_POINT(-84.71192589,45.69757172,4269),15)
      ,(60001900002920,ARRAY[60002500003817],ST_POINT(-84.71216238,45.69769044,4269),15)
      ,(60001900002920,ARRAY[60002500003817],ST_POINT(-84.7229728,45.70021805,4269),15)
      ,(60002500001381,ARRAY[60001900002920],ST_POINT(-84.73941511,45.70920924,4269),15)
      ,(60001900004624,ARRAY[60002500001381],ST_POINT(-84.72835079,45.72333412,4269),15)
      ,(60002500000944,ARRAY[60001900010183],ST_POINT(-84.72868389,45.74875654,4269),15)
      ,(60002500018160,ARRAY[60001900010183],ST_POINT(-84.73209872,45.75683436,4269),15)
      ,(60001900002443,ARRAY[60002500014076],ST_POINT(-84.60515628,45.64462358,4269),30)
      ,(60002500014076,ARRAY[60001900002443],ST_POINT(-84.60824311,45.64578422,4269),15)
      ,(60002500014076,ARRAY[60001900002443],ST_POINT(-84.61967123,45.65218939,4269),15)
      ,(60002500025629,ARRAY[60001900002443],ST_POINT(-84.62776879,45.65768683,4269),15)
      ,(60001900002443,ARRAY[60002500025629],ST_POINT(-84.63813564,45.66281863,4269),15)
      ,(60001900002443,ARRAY[60002500025837],ST_POINT(-84.64700501,45.66528592,4269),15)
      ,(60001900008410,ARRAY[60002500023922],ST_POINT(-84.64191373,45.62034536,4269),15)
      ,(60002500023922,ARRAY[60001900008410],ST_POINT(-84.64303825,45.61753679,4269),15)
      ,(60002500025834,ARRAY[60001900008280,60002500007602,60001900000711],ST_POINT(-84.64064286,45.60509752,4269),15)
      ,(60001900005919,ARRAY[60002500005193,60001900002802],ST_POINT(-84.57539453,45.60774512,4269),15)
      ,(60002500021580,ARRAY[60001900007370],ST_POINT(-84.85658864,45.32182989,4269),15)
      ,(60002500021580,ARRAY[60001900005931,60002500001579],ST_POINT(-84.88355629,45.32733128,4269),15)
      ,(60001900002054,ARRAY[60002500023054,60001900006790],ST_POINT(-84.9014916,45.35779107,4269),15)
      ,(60001900006790,ARRAY[60002500028171],ST_POINT(-84.8972193,45.35951902,4269),15)
      ,(60002500026451,ARRAY[60001900005915],ST_POINT(-84.89825756,45.38414275,4269),15)
      ,(60002500026451,ARRAY[60001900005739],ST_POINT(-84.90475144,45.38757739,4269),15)
      ,(60002500026451,ARRAY[60001900005739],ST_POINT(-84.90563791,45.38765492,4269),15)
      ,(60002500013864,ARRAY[60001900004980],ST_POINT(-84.90477366,45.39826825,4269),15)
      ,(60001900007694,ARRAY[60002500013864],ST_POINT(-84.90990341,45.41843641,4269),15)
      ,(60002500013864,ARRAY[60001900007694],ST_POINT(-84.90705873,45.42780791,4269),15)
      ,(60001900007694,ARRAY[60002500013864],ST_POINT(-84.91254632,45.43196338,4269),15)
      ,(60001900003227,ARRAY[60002500007382],ST_POINT(-84.89785803,45.45059613,4269),15)
      ,(60001900006774,ARRAY[60002500006296],ST_POINT(-84.79445828,45.2706574,4269),30)
      ,(60001900006774,ARRAY[60002500006296],ST_POINT(-84.78439169,45.27212792,4269),30)
      ,(60001900006774,ARRAY[60002500006296],ST_POINT(-84.78420206,45.27251561,4269),15)
      ,(60001900006774,ARRAY[60002500006296],ST_POINT(-84.78475037,45.27456096,4269),15)
      ,(60001900006226,ARRAY[60002500006296],ST_POINT(-84.78293992,45.27539868,4269),15)
      ,(60001900006226,ARRAY[60002500006296],ST_POINT(-84.77800723,45.27453642,4269),30)
      ,(60002500001584,ARRAY[60001900006226],ST_POINT(-84.75877892,45.24502972,4269),15)
      ,(60001900009412,ARRAY[60002500002295],ST_POINT(-84.7667972,45.07089337,4269),15)
      ,(60002500021148,ARRAY[60001900006475],ST_POINT(-84.79996901,45.15260746,4269),15)
      ,(60002500021148,ARRAY[60001900006475],ST_POINT(-84.79975789,45.1538485,4269),15)
      ,(60001900005329,ARRAY[60002500020043],ST_POINT(-84.78990892,45.20263837,4269),15)
      ,(60002500001584,ARRAY[60001900006878],ST_POINT(-84.76158508,45.22761355,4269),15)
      ,(60002500022545,ARRAY[60001900008604],ST_POINT(-84.75978251,44.63750723,4269),15)
      ,(60001900008604,ARRAY[60002500022545],ST_POINT(-84.76784929,44.66160577,4269),15)
      ,(60001900006776,ARRAY[60002500026476],ST_POINT(-84.76059479,44.68061395,4269),15)
      ,(60002500026476,ARRAY[60001900005437],ST_POINT(-84.7781049,44.69999611,4269),15)
      ,(60002500011585,ARRAY[60001900006113],ST_POINT(-84.78431815,44.72910742,4269),15)
      ,(60001900007637,ARRAY[60002500012015],ST_POINT(-84.79716329,44.83537032,4269),15)
      ,(60001900007637,ARRAY[60002500012015],ST_POINT(-84.79599145,44.83482452,4269),15)
      ,(60001900007637,ARRAY[60002500012015],ST_POINT(-84.79562886,44.83469586,4269),15)
      ,(60002500022545,ARRAY[60001900004786],ST_POINT(-84.8004909,44.60549552,4269),15)
      ,(60002500022545,ARRAY[60001900004786],ST_POINT(-84.80072897,44.60859446,4269),15)
      ,(60002500024470,ARRAY[60001900004786],ST_POINT(-84.81454212,44.52323292,4269),15)
      ,(60002500015505,ARRAY[60001900006019,60001900010039],ST_POINT(-84.75830277,44.52319151,4269),15)
      ,(60002500020831,ARRAY[60001900007285],ST_POINT(-84.69603487,44.51130246,4269),15)
      ,(60001900007285,ARRAY[60002500020831],ST_POINT(-84.6848632,44.51135508,4269),30)
      ,(60002500020831,ARRAY[60001900006882],ST_POINT(-84.67380335,44.50380703,4269),15)
      ,(60001900002643,ARRAY[60002500009230],ST_POINT(-84.61675991,44.46873985,4269),15)
      ,(60001900002643,ARRAY[60002500009230],ST_POINT(-84.61937393,44.4570292,4269),15)
      ,(60002500009230,ARRAY[60001900002643],ST_POINT(-84.6197192,44.45488852,4269),15)
      ,(60002500009230,ARRAY[60001900002643],ST_POINT(-84.61997779,44.45038856,4269),15)
      ,(60002500004422,ARRAY[60001900006538],ST_POINT(-84.4995365,44.3212144,4269),15)
      ,(60002500020720,ARRAY[60001900006538],ST_POINT(-84.49739095,44.31823143,4269),15)
      ,(60001900006538,ARRAY[60002500020720],ST_POINT(-84.49702636,44.31810698,4269),15)
      ,(60002500025639,ARRAY[60001900008558],ST_POINT(-84.48093817,44.30775633,4269),15)
      ,(60001900009057,ARRAY[60002500007304],ST_POINT(-84.46132692,44.2905915,4269),15)
      ,(60002500007304,ARRAY[60001900007000],ST_POINT(-84.45575065,44.28848338,4269),15)
      ,(60002500007304,ARRAY[60001900007000],ST_POINT(-84.4491883,44.2875494,4269),15)
      ,(60002500007304,ARRAY[60001900007000],ST_POINT(-84.43945035,44.28895633,4269),15)
      ,(60001900000305,ARRAY[60002500007304],ST_POINT(-84.43248247,44.29268687,4269),15)
      ,(60001900000305,ARRAY[60002500007304],ST_POINT(-84.43099562,44.29247366,4269),15)
      ,(60001900000305,ARRAY[60002500007304],ST_POINT(-84.4265917,44.29235371,4269),15)
      ,(60002500007304,ARRAY[60001800014207,60001900000305],ST_POINT(-84.41323197,44.29164364,4269),30)
      ,(60002500020720,ARRAY[60001900006538],ST_POINT(-84.49739105,44.31822994,4269),15)
      ,(60001900006538,ARRAY[60002500020720],ST_POINT(-84.49702597,44.318104,4269),15)
      ,(60002500004422,ARRAY[60001900005280],ST_POINT(-84.52989968,44.34003397,4269),15)
      ,(60001900005280,ARRAY[60002500004422],ST_POINT(-84.5301704,44.3399634,4269),15)
      ,(60002500004422,ARRAY[60001900005280],ST_POINT(-84.53043533,44.33989398,4269),15)
      ,(60002500004422,ARRAY[60001900005280],ST_POINT(-84.5327642,44.33955154,4269),15)
      ,(60001900005280,ARRAY[60002500004422],ST_POINT(-84.54912065,44.34024106,4269),15)
      ,(60001900005280,ARRAY[60002500004422],ST_POINT(-84.55420587,44.34240275,4269),15)
      ,(60002500004422,ARRAY[60001900005280],ST_POINT(-84.55566348,44.34352165,4269),15)
      ,(60002500014441,ARRAY[60001900005280],ST_POINT(-84.55714257,44.34600066,4269),15)
      ,(60002500014441,ARRAY[60001900005280],ST_POINT(-84.55687326,44.34832506,4269),15)
      ,(60001900005280,ARRAY[60002500014441],ST_POINT(-84.56040932,44.35134684,4269),15)
      ,(60001900005280,ARRAY[60002500014441],ST_POINT(-84.56603555,44.35481018,4269),15)
      ,(60001900005280,ARRAY[60002500014441],ST_POINT(-84.56603678,44.35481509,4269),15)
      ,(60002500014441,ARRAY[60001900005280],ST_POINT(-84.5568652,44.34832516,4269),15)
      ,(60001900005280,ARRAY[60002500014441],ST_POINT(-84.57457966,44.36268583,4269),15)
      ,(60002500014441,ARRAY[60001900005280],ST_POINT(-84.57726644,44.36481695,4269),15)
      ,(60001900005280,ARRAY[60002500014441],ST_POINT(-84.58847678,44.38765582,4269),15)
      ,(60002500003978,ARRAY[60002500026590,60001800025307],ST_POINT(-84.72390112,44.119054,4269),15)
      ,(60002500014680,ARRAY[60001800023282,60002500010936],ST_POINT(-84.57323949,44.19185963,4269),15)
      ,(60001800011411,ARRAY[60002600017900],ST_POINT(-84.49336321,43.24937884,4269),15)
      ,(60002600018740,ARRAY[60001800019868,60001800017755],ST_POINT(-84.47201463,43.2569689,4269),15)
      ,(60001800017461,ARRAY[60002600010689,60001800017524],ST_POINT(-84.81868962,43.2869312,4269),50)
      ,(60001800017194,ARRAY[60001800017313,60002600006252],ST_POINT(-84.71777541,43.28327632,4269),15)
      ,(60001800017817,ARRAY[60002600000518,60002600003781],ST_POINT(-84.38464484,43.11787356,4269),15)
      ,(60002600012314,ARRAY[60001800017889],ST_POINT(-84.4077467,43.14609329,4269),15)
      ,(60001800017889,ARRAY[60002600012314],ST_POINT(-84.40771471,43.14551062,4269),30)
      ,(60001800017889,ARRAY[60002600012314],ST_POINT(-84.40928207,43.14811507,4269),15)
      ,(60002600012314,ARRAY[60001800017889],ST_POINT(-84.40933919,43.14847567,4269),30)
      ,(60001800017889,ARRAY[60002600012314],ST_POINT(-84.40934276,43.14848638,4269),30)
      ,(60002600012314,ARRAY[60001800017889],ST_POINT(-84.40938203,43.14895766,4269),30)
      ,(60001800017889,ARRAY[60002600012314],ST_POINT(-84.40943202,43.1493968,4269),15)
      ,(60001800019996,ARRAY[60001800000601,60002600006431],ST_POINT(-84.33225021,43.11933441,4269),15)
      ,(60002600018240,ARRAY[60001800019281,60002600005104],ST_POINT(-84.28425788,43.03885736,4269),20)
      ,(60002600014488,ARRAY[60001800015726,60001800011880],ST_POINT(-84.2923566,43.08586872,4269),35)
      ,(60001300023833,ARRAY[60002600013491,60002600001731],ST_POINT(-84.26342954,42.16849545,4269),15)
      ,(60001300007163,ARRAY[60001300010564,60002600006277],ST_POINT(-84.1001132,42.38036588,4269),15)
      ,(60001800012736,ARRAY[60002500001306,60001800024823],ST_POINT(-84.85577866,44.00431042,4269),25)
      ,(60002500001306,ARRAY[60001800012736,60002500022367],ST_POINT(-84.86224662,43.99324729,4269),15)
      ,(60001800002991,ARRAY[60002500014467,60002500022560],ST_POINT(-85.292784,43.80084554,4269),15)
      ,(60001800005368,ARRAY[60002500015919,60001800008213],ST_POINT(-85.2328576,43.80660216,4269),15)
      ,(60001800008088,ARRAY[60002500023670,60001800005189],ST_POINT(-85.20484759,43.83508158,4269),15)
      ,(60002500028266,ARRAY[60001800017530,60001800014231],ST_POINT(-85.14170809,43.60052333,4269),25)
      ,(60002600009966,ARRAY[60001800007683,60002600005393],ST_POINT(-85.10153001,43.47234187,4269),25)
      ,(60001800008616,ARRAY[60001800002989,60002500020009],ST_POINT(-85.13112852,43.66914896,4269),25)
      ,(60002500020008,ARRAY[60001800016882,60002500021089],ST_POINT(-85.22848036,43.68682029,4269),25)
      ,(60002600010688,ARRAY[60001800017677],ST_POINT(-84.92093695,43.32696614,4269),15)
      ,(60001800017677,ARRAY[60002600010688,60002600011652],ST_POINT(-84.921182,43.32771026,4269),15)
      ,(60001300023408,ARRAY[60002600012509,60001300030466],ST_POINT(-84.10758594,42.50032309,4269),15)
      ,(60002600009545,ARRAY[60001300029230,60001300032050],ST_POINT(-84.45607822,42.00530374,4269),15)
      ,(60002600006180,ARRAY[60001300018132],ST_POINT(-84.46774196,41.97114067,4269),15)
      ,(60001300116530,ARRAY[60002600108284,60001300116531],ST_POINT(-84.87024778,41.73472444,4269),15)
      ,(60001300011719,ARRAY[60002600000161,60001300021124],ST_POINT(-84.64047271,41.86596275,4269),15)
      ,(60002600020180,ARRAY[60001800004348,60002600013161],ST_POINT(-84.07520582,42.70501234,4269),15)
      ,(60002600123246,ARRAY[60001300104113,60001300104102,60001300092851,60002600050453],ST_POINT(-84.89089118,41.60726245,4269),25)
      ,(60001300103891,ARRAY[60002600034602,60002600093107,60002600075589],ST_POINT(-85.07119034,41.52118354,4269),15)
      ,(60002600113178,ARRAY[60001300089368,60001300095250],ST_POINT(-85.24158947,41.40704897,4269),15)

   ) AS t(expand,static,patch,size)
   LOOP
      IF r.expand = ANY(r.static)
      THEN
         RAISE EXCEPTION 'QA failure for % with same value in static list',r.expand;
      
      END IF;   
   
      BEGIN
         patchgeo := ST_BUFFER(
             ST_TRANSFORM(r.patch,int_srid)
            ,r.size
            ,'quad_segs=2'
         );
         
      EXCEPTION
         WHEN OTHERS THEN
            RAISE WARNING '% % % %',r.expand,r.static,ST_ASEWKT(r.patch),r.size;
            RAISE;
      
      END;
      
      SELECT
      ST_UNION(
         cipsrv_nhdplus_h.snap_to_common_grid(ST_TRANSFORM(a.shape,int_srid),int_srid::VARCHAR,0.001)
      )
      INTO staticgeo
      FROM (
         SELECT
          aa.nhdplusid
         ,aa.shape
         FROM
         cipsrv_nhdplus_h.nhdpluscatchment aa
         UNION ALL
         SELECT
          bb.nhdplusid
         ,bb.shape
         FROM
         cipsrv_epageofab_h.grid0catchment bb
      ) a
      WHERE 
      a.nhdplusid = ANY(r.static);
      
      IF staticgeo IS NULL
      OR ST_ISEMPTY(staticgeo)
      OR ST_SRID(staticgeo) = 0
      THEN
         RAISE EXCEPTION '% % % %',r.expand,r.static,ST_ASEWKT(r.patch),r.size;
         
      END IF;
      
      IF ST_DISTANCE(
          patchgeo
         ,staticgeo
      ) > 50
      THEN
         RAISE EXCEPTION 'QA distance check for % %',r.expand,r.static;
      
      END IF;
      
      BEGIN
         SELECT
         ST_UNION(
             cipsrv_nhdplus_h.snap_to_common_grid(ST_TRANSFORM(a.shape,int_srid),int_srid::VARCHAR,0.001)
            ,cipsrv_nhdplus_h.snap_to_common_grid(patchgeo,int_srid::VARCHAR,0.001)
         )
         INTO step1geo
         FROM
         cipsrv_nhdplus_h.nhdpluscatchment a
         WHERE
         a.nhdplusid = r.expand;
      
      EXCEPTION
         WHEN OTHERS THEN
            RAISE WARNING '% % % %',r.expand,r.static,ST_ASEWKT(r.patch),r.size;
            RAISE;
      
      END;
      
      IF step1geo IS NULL
      OR ST_ISEMPTY(step1geo)
      OR ST_SRID(step1geo) = 0
      THEN
         RAISE EXCEPTION '% % % % %',r.expand,r.static,ST_ASEWKT(r.patch),r.size,ST_ASEWKT(step1geo);
         
      END IF;
      
      BEGIN
         SELECT
         ST_DIFFERENCE(
             step1geo
            ,staticgeo
         )
         INTO step2geo;
      
      EXCEPTION
         WHEN OTHERS THEN
            RAISE WARNING '% % % %',r.expand,r.static,ST_ASEWKT(r.patch),r.size;
            RAISE;
      
      END;
      
      IF step2geo IS NULL
      OR ST_ISEMPTY(step2geo)
      OR ST_SRID(step2geo) = 0
      THEN
         RAISE EXCEPTION '% % % % %',r.expand,r.static,ST_ASEWKT(r.patch),r.size,ST_ASEWKT(step2geo);
         
      END IF;
      
      BEGIN
         UPDATE cipsrv_nhdplus_h.nhdpluscatchment a
         SET shape = ST_TRANSFORM(step2geo,4269)
         WHERE 
         a.nhdplusid = r.expand;
         
      EXCEPTION
         WHEN OTHERS THEN
            RAISE WARNING '% % % %',r.expand,r.static,ST_ASEWKT(r.patch),r.size;
         RAISE;
         
      END;
         
      UPDATE cipsrv_nhdplus_h.nhdpluscatchment a
      SET areasqkm = ST_AREA(ST_TRANSFORM(a.shape,int_srid))::NUMERIC / 1000000
      WHERE 
      a.nhdplusid = r.expand;
        
   END LOOP;
    
END$$;

